htmx.defineExtension("safe-nonce",{transformResponse:function(e,n,o){htmx.config.refreshOnHistoryMiss=true;let t=new RegExp(`<script(\\s[^>]*>|>).*?<\\/script(\\s[^>]*>|>)`,"gis");let r=n.getResponseHeader("HX-Nonce");if(!r){const i=n.getResponseHeader("content-security-policy");if(i){const s=i.match(/(default|script)-src[^;]*'nonce-([^']*)'/i);if(s){r=s[2]}}}if(window.location.hostname){const c=new URL(n.responseURL);if(c.hostname!==window.location.hostname){r=""}}if(r){t=new RegExp(`<script(\\s(?!nonce="${r.replace(/[\\\[\]\/^*.+?$(){}'#:!=|]/g,"\\$&")}")[^>]*>|>).*?<\\/script(\\s[^>]*>|>)`,"gis")}return e.replace(t,"").replace(/ignore:safe-nonce/g,"")},onEvent:function(e,n){if(e==="htmx:load"){Array.from(n.detail.elt.querySelectorAll("script")).forEach(e=>{if(e.nonce!==htmx.config.inlineScriptNonce){e.remove()}});Array.from(n.detail.elt.querySelectorAll('[hx-ext*="ignore:safe-nonce"], [data-hx-ext*="ignore:safe-nonce"]')).forEach(e=>{e.remove()})}}});